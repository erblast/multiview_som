"0","link = tibble( map_loc = names(som_cluster_adj) %>% as.integer()"
"0","               ,cluster = som_cluster_adj)"
"0","pred = tibble( map_loc = m$unit.classif) %>%"
"0","  left_join(link)"
"2","Joining, by = ""map_loc""
"
"0","data_pred = data %>%"
"0","  bind_cols(pred)"
"0","# plot numericals absolute values"
"0","# d_plot = data_pred %>%"
"0","#   as_tibble() %>%"
"0","#   select( one_of(numerics), cluster ) %>%"
"0","#   gather(key = 'key', value = 'value', one_of(numerics) )"
"0","# "
"0","# medians = d_plot %>%"
"0","#   group_by(key, cluster) %>%"
"0","#   summarize_all( median)"
"0","# "
"0","# ggplot(d_plot, aes(x = as.factor(cluster)"
"0","#                    , y = value) ) +"
"0","#   geom_violin( aes( fill = as.factor(cluster)) ) +"
"0","#   geom_crossbar( data = medians"
"0","#                  , mapping = aes(x = as.factor(cluster)"
"0","#                                  ,ymin = value"
"0","#                                  ,ymax = value)) +"
"0","#   facet_wrap(~key"
"0","#              , scales = 'free_y'"
"0","#              , ncol = 1)+"
"0","#   labs(title = 'Absolute Values of\nnumeric variables'"
"0","#        ) "
"0","# plot numericals scaled values"
"0","d_plot_scale = data %>%"
"0","  select( one_of(numerics) ) %>%"
"0","  scale(center = T) %>%"
"0","  as_tibble() %>%"
"0","  bind_cols(pred) %>%"
"0","  gather(key = 'key', value = 'value', one_of(numerics) )"
"0","medians = d_plot_scale %>%"
"0","  group_by(key, cluster) %>%"
"0","  summarize_all( median)"
"0","ggplot(medians, aes(x = as.factor(key)"
"0","                   , y = value) ) +"
"0","  geom_bar( aes( fill = as.factor(key))"
"0","            ,stat = 'identity') +"
"0","  geom_hline(yintercept = 0"
"0","             ,size = 1) +"
"0","  facet_wrap(~cluster"
"0","             , ncol = 1"
"0","             ) +"
"0","  labs(title = 'Median values of scaled and centered\nnumeric variables')"
